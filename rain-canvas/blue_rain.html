<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Mario Rain</title>
</head>

<body>

    <canvas id="rain-canvas" width="1000" height="600" style="border:3px solid black;"></canvas>
    <script>
        const canvas = document.getElementById('rain-canvas')
        const context = canvas.getContext('2d');

        function random(low, high) {
            return Math.floor((Math.random()) * (high - low) + low)
        }

        const balls = []

        function Ball() {
            this.x = random(0, canvas.width)
            this.y = 0
            this.radius = random(5, 10)
            this.vy = 2
            this.gravity = 0.1
            this.id = balls.length
            this.life = 0
            this.color = `rgb(0, 0, ${random(0,255)})`
            this.maxLife = 200 
        }

        Ball.prototype.draw = function () {
            context.fillStyle = this.color;
            context.beginPath();
            context.arc(this.x, this.y, this.radius, 0, 2 * Math.PI)
            context.stroke()
            context.fill()
            context.closePath();
        }

        Ball.prototype.update = function () {
            this.life += 1
            this.y += this.vy
            this.vy += this.gravity
            // this.x += random(-1,2)  
            if (this.life > this.maxLife) {
                balls.splice(this.id, 1)
            }
        }

        const ballsPerFrame = 1

        // one Frame will execute gameloop() -> or say 60 times this loop will run in 1 sec as Framerate = 60 per second  
        function gameLoop() {
            context.fillStyle = 'rgba(0,0,0,0.8)' // try using 0.08
            context.fillRect(0, 0, canvas.width, canvas.height)
            for (let i = 0; i < ballsPerFrame; i++) {
                balls.push(new Ball())
            }

            for (b in balls) {
                balls[b].draw()
                balls[b].update()
            }
            window.requestAnimationFrame(gameLoop)
        }

        gameLoop()
    </script>
</body>

</html>